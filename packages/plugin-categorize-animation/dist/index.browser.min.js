var jsPsychCategorizeAnimation=function(a){"use strict";var v="2.1.0";const T={name:"categorize-animation",version:v,parameters:{stimuli:{type:a.ParameterType.IMAGE,default:void 0,array:!0},key_answer:{type:a.ParameterType.KEY,default:void 0},choices:{type:a.ParameterType.KEYS,default:"ALL_KEYS"},text_answer:{type:a.ParameterType.HTML_STRING,default:null},correct_text:{type:a.ParameterType.HTML_STRING,default:"Correct."},incorrect_text:{type:a.ParameterType.HTML_STRING,default:"Wrong."},frame_time:{type:a.ParameterType.INT,default:500},sequence_reps:{type:a.ParameterType.INT,default:1},allow_response_before_complete:{type:a.ParameterType.BOOL,default:!1},feedback_duration:{type:a.ParameterType.INT,default:2e3},prompt:{type:a.ParameterType.HTML_STRING,default:null},render_on_canvas:{type:a.ParameterType.BOOL,default:!0}},data:{stimulus:{type:a.ParameterType.STRING,array:!0},response:{type:a.ParameterType.STRING},rt:{type:a.ParameterType.INT},correct:{type:a.ParameterType.BOOL}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class p{constructor(t){this.jsPsych=t}trial(t,e){var r=0,s=0,n=!0,u=!1,d=!1,m;if(e.render_on_canvas){if(t.hasChildNodes())for(;t.firstChild;)t.removeChild(t.firstChild);var i=document.createElement("canvas");i.id="jspsych-categorize-animation-stimulus",i.style.margin="0",i.style.padding="0",t.insertBefore(i,null);var g=i.getContext("2d");if(e.prompt!==null){var l=document.createElement("div");l.id="jspsych-categorize-animation-prompt",l.style.visibility="hidden",l.innerHTML=e.prompt,t.insertBefore(l,i.nextElementSibling)}var h=document.createElement("div");t.insertBefore(h,t.nextElementSibling)}const y=()=>{if(n)if(e.render_on_canvas){t.querySelector("#jspsych-categorize-animation-stimulus").style.visibility="visible";var o=new Image;o.src=e.stimuli[r],i.height=o.naturalHeight,i.width=o.naturalWidth,g.drawImage(o,0,0)}else t.innerHTML+='<img src="'+e.stimuli[r]+'" class="jspsych-categorize-animation-stimulus"></img>';if(!u&&e.allow_response_before_complete)e.prompt!==null&&(e.render_on_canvas?l.style.visibility="visible":t.innerHTML+=e.prompt),e.render_on_canvas&&(n||i.remove());else if(!u)n||(e.prompt!==null&&(e.render_on_canvas?l.style.visibility="visible":t.innerHTML+=e.prompt),e.render_on_canvas&&i.remove());else{var c="";m?c=e.correct_text.replace("%ANS%",e.text_answer):c=e.incorrect_text.replace("%ANS%",e.text_answer),e.render_on_canvas?(e.prompt!==null&&l.remove(),h.innerHTML=c):t.innerHTML+=c,d||(d=!0,this.jsPsych.pluginAPI.setTimeout(()=>{b()},e.feedback_duration))}};var P=setInterval(()=>{e.render_on_canvas||(t.innerHTML=""),r++,r==e.stimuli.length&&(r=0,s++,e.sequence_reps!=-1&&s>=e.sequence_reps&&(n=!1)),y()},e.frame_time);y();const b=()=>{clearInterval(P),this.jsPsych.finishTrial(f)};var _,f={};const w=o=>{if(!e.allow_response_before_complete&&n)return!1;m=!1,this.jsPsych.pluginAPI.compareKeys(e.key_answer,o.key)&&(m=!0),u=!0,f={stimulus:e.stimuli,rt:o.rt,correct:m,response:o.key},this.jsPsych.pluginAPI.cancelKeyboardResponse(_)};_=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:w,valid_responses:e.choices,rt_method:"performance",persist:!0,allow_held_key:!1})}simulate(t,e,r,s){e=="data-only"&&(s(),this.simulate_data_only(t,r)),e=="visual"&&this.simulate_visual(t,r,s)}create_simulation_data(t,e){const r=t.sequence_reps*t.frame_time*t.stimuli.length,s=this.jsPsych.pluginAPI.getValidKey(t.choices),n={stimulus:t.stimuli,rt:r+this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),response:s,correct:s==t.key_answer},u=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,u),u}simulate_data_only(t,e){const r=this.create_simulation_data(t,e);if(r.rt==null||r.response==null)throw new Error(`
        Simulated response for categorize-animation plugin was invalid. 
        This could be because the response RT was too fast and generated
        before the animation finished when the allow_response_before_complete
        parameter is false. In a real experiment this would cause the experiment
        to pause indefinitely.`);this.jsPsych.finishTrial(r)}simulate_visual(t,e,r){const s=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();if(this.trial(n,t),r(),s.rt!==null)this.jsPsych.pluginAPI.pressKey(s.response,s.rt);else throw new Error(`
        Simulated response for categorize-animation plugin was invalid. 
        This could be because the response RT was too fast and generated
        before the animation finished when the allow_response_before_complete
        parameter is false. In a real experiment this would cause the experiment
        to pause indefinitely.`)}}return p.info=T,p}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
