var jsPsychInitializeCamera=function(n){"use strict";var m="2.1.0",d=(h,t,e)=>new Promise((i,a)=>{var r=o=>{try{l(e.next(o))}catch(c){a(c)}},s=o=>{try{l(e.throw(o))}catch(c){a(c)}},l=o=>o.done?i(o.value):Promise.resolve(o.value).then(r,s);l((e=e.apply(h,t)).next())});const p={name:"initialize-camera",version:m,parameters:{device_select_message:{type:n.ParameterType.HTML_STRING,default:"<p>Please select the camera you would like to use.</p>"},button_label:{type:n.ParameterType.STRING,default:"Use this camera"},include_audio:{type:n.ParameterType.BOOL,default:!1},width:{type:n.ParameterType.INT,default:null},height:{type:n.ParameterType.INT,default:null},mime_type:{type:n.ParameterType.STRING,default:null}},data:{device_id:{type:n.ParameterType.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class u{constructor(t){this.jsPsych=t}trial(t,e){this.run_trial(t,e).then(i=>{this.jsPsych.finishTrial({device_id:i})})}run_trial(t,e){return d(this,null,function*(){yield this.askForPermission(e),this.showCameraSelection(t,e),this.updateDeviceList(t),navigator.mediaDevices.ondevicechange=l=>{this.updateDeviceList(t)};const i=yield this.waitForSelection(t),a={video:{deviceId:i}};e.width&&(a.video.width=e.width),e.height&&(a.video.height=e.height),e.include_audio&&(a.audio=!0);const r=yield navigator.mediaDevices.getUserMedia(a),s={};return e.mime_type&&(s.mimeType=e.mime_type),this.jsPsych.pluginAPI.initializeCameraRecorder(r,s),i})}askForPermission(t){return d(this,null,function*(){return yield navigator.mediaDevices.getUserMedia({audio:t.include_audio,video:!0})})}showCameraSelection(t,e){let i=`
      ${e.device_select_message}
      <select name="camera" id="which-camera" style="font-size:14px; font-family: 'Open Sans', 'Arial', sans-serif; padding: 4px;">
      </select>
      <p><button class="jspsych-btn" id="btn-select-camera">${e.button_label}</button></p>`;t.innerHTML=i}waitForSelection(t){return new Promise(e=>{t.querySelector("#btn-select-camera").addEventListener("click",()=>{const i=t.querySelector("#which-camera").value;e(i)})})}updateDeviceList(t){navigator.mediaDevices.enumerateDevices().then(e=>{const i=e.filter(a=>a.kind==="videoinput"&&a.deviceId!=="default"&&a.deviceId!=="communications").filter((a,r,s)=>s.findIndex(l=>l.groupId==a.groupId)==r);t.querySelector("#which-camera").innerHTML="",i.forEach(a=>{let r=document.createElement("option");r.value=a.deviceId,r.innerHTML=a.label,t.querySelector("#which-camera").appendChild(r)})})}}return u.info=p,u}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
