var jsPsychVideoSliderResponse=function(r){"use strict";var b="2.1.1";const g={name:"video-slider-response",version:b,parameters:{stimulus:{type:r.ParameterType.VIDEO,default:void 0,array:!0},prompt:{type:r.ParameterType.HTML_STRING,default:null},width:{type:r.ParameterType.INT,default:null},height:{type:r.ParameterType.INT,default:null},autoplay:{type:r.ParameterType.BOOL,default:!0},controls:{type:r.ParameterType.BOOL,default:!1},start:{type:r.ParameterType.FLOAT,default:null},stop:{type:r.ParameterType.FLOAT,default:null},rate:{type:r.ParameterType.FLOAT,default:1},min:{type:r.ParameterType.INT,default:0},max:{type:r.ParameterType.INT,default:100},slider_start:{type:r.ParameterType.INT,default:50},step:{type:r.ParameterType.INT,default:1},labels:{type:r.ParameterType.HTML_STRING,default:[],array:!0},slider_width:{type:r.ParameterType.INT,default:null},button_label:{type:r.ParameterType.STRING,default:"Continue"},require_movement:{type:r.ParameterType.BOOL,default:!1},trial_ends_after_video:{type:r.ParameterType.BOOL,default:!1},trial_duration:{type:r.ParameterType.INT,default:null},response_ends_trial:{type:r.ParameterType.BOOL,default:!0},response_allowed_while_playing:{type:r.ParameterType.BOOL,default:!0}},data:{response:{type:r.ParameterType.INT},rt:{type:r.ParameterType.INT},stimulus:{type:r.ParameterType.STRING,array:!0},slider_start:{type:r.ParameterType.INT},start:{type:r.ParameterType.FLOAT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class v{constructor(t){this.jsPsych=t}trial(t,e){var l=7.5,s='<video id="jspsych-video-slider-response-stimulus-video"';e.width&&(s+=' width="'+e.width+'"'),e.height&&(s+=' height="'+e.height+'"'),e.autoplay&&e.start==null&&(s+=" autoplay "),e.controls&&(s+=" controls "),e.start!==null&&(s+=' style="visibility: hidden;"'),s+=">";var o=this.jsPsych.pluginAPI.getVideoBuffer(e.stimulus[0]);if(!o)for(var p=0;p<e.stimulus.length;p++){var n=e.stimulus[p];n.indexOf("?")>-1&&(n=n.substring(0,n.indexOf("?")));var u=n.substr(n.lastIndexOf(".")+1);u=u.toLowerCase(),u=="mov"&&console.warn("Warning: video-slider-response plugin does not reliably support .mov files."),s+='<source src="'+n+'" type="video/'+u+'">'}s+="</video>";var i='<div id="jspsych-video-slider-response-wrapper" style="margin: 100px 0px;">';i+='<div id="jspsych-video-slider-response-stimulus">'+s+"</div>",i+='<div class="jspsych-video-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',e.slider_width!==null?i+=e.slider_width+"px;":i+="auto;",i+='">',i+='<input type="range" class="jspsych-slider" value="'+e.slider_start+'" min="'+e.min+'" max="'+e.max+'" step="'+e.step+'" id="jspsych-video-slider-response-response"',e.response_allowed_while_playing||(i+=" disabled"),i+="></input><div>";for(var y=0;y<e.labels.length;y++){var h=100/(e.labels.length-1),_=y*(100/(e.labels.length-1)),w=(_-50)/50*100,S=w*l/100;i+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+_+"% - ("+h+"% / 2) - "+S+"px); text-align: center; width: "+h+'%;">',i+='<span style="text-align: center; font-size: 80%;">'+e.labels[y]+"</span>",i+="</div>"}i+="</div>",i+="</div>",i+="</div>",e.prompt!==null&&(i+="<div>"+e.prompt+"</div>");var T="";(e.require_movement||!e.response_allowed_while_playing)&&(T="disabled"),i+='<button id="jspsych-video-slider-response-next" class="jspsych-btn" '+T+">"+e.button_label+"</button>",t.innerHTML=i;var a=t.querySelector("#jspsych-video-slider-response-stimulus-video");o&&(a.src=o),a.onended=()=>{e.trial_ends_after_video?c():e.response_allowed_while_playing||f()},a.playbackRate=e.rate,e.start!==null&&(a.pause(),a.onseeked=()=>{a.style.visibility="visible",a.muted=!1,e.autoplay?a.play():a.pause(),a.onseeked=()=>{}},a.onplaying=()=>{a.currentTime=e.start,a.onplaying=()=>{}},a.muted=!0,a.play());let P=!1;if(e.stop!==null&&a.addEventListener("timeupdate",d=>{var I=a.currentTime;I>=e.stop&&(a.pause(),e.trial_ends_after_video&&!P&&(P=!0,c()),e.response_allowed_while_playing||f())}),e.require_movement){const d=()=>{t.querySelector("#jspsych-video-slider-response-next").disabled=!1};t.querySelector("#jspsych-video-slider-response-response").addEventListener("mousedown",d),t.querySelector("#jspsych-video-slider-response-response").addEventListener("touchstart",d),t.querySelector("#jspsych-video-slider-response-response").addEventListener("change",d)}var L=performance.now(),m={rt:null,response:null};const c=()=>{t.querySelector("#jspsych-video-slider-response-stimulus-video").pause(),t.querySelector("#jspsych-video-slider-response-stimulus-video").onended=()=>{};var d={rt:m.rt,stimulus:e.stimulus,start:e.start,slider_start:e.slider_start,response:m.response};this.jsPsych.finishTrial(d)};t.querySelector("#jspsych-video-slider-response-next").addEventListener("click",()=>{var d=performance.now();m.rt=Math.round(d-L),m.response=t.querySelector("#jspsych-video-slider-response-response").valueAsNumber,e.response_ends_trial?c():t.querySelector("#jspsych-video-slider-response-next").disabled=!0});function f(){document.querySelector("#jspsych-video-slider-response-response").disabled=!1,e.require_movement||(document.querySelector("#jspsych-video-slider-response-next").disabled=!1)}e.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(c,e.trial_duration)}simulate(t,e,l,s){e=="data-only"&&(s(),this.simulate_data_only(t,l)),e=="visual"&&this.simulate_visual(t,l,s)}create_simulation_data(t,e){const l={stimulus:t.stimulus,slider_start:t.slider_start,response:this.jsPsych.randomization.randomInt(t.min,t.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),start:t.start},s=this.jsPsych.pluginAPI.mergeSimulationData(l,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,s),s}simulate_data_only(t,e){const l=this.create_simulation_data(t,e);this.jsPsych.finishTrial(l)}simulate_visual(t,e,l){const s=this.create_simulation_data(t,e),o=this.jsPsych.getDisplayElement();this.trial(o,t),l();const p=o.querySelector("#jspsych-video-button-response-stimulus"),n=()=>{if(s.rt!==null){const u=o.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(u),u.valueAsNumber=s.response},s.rt/2),this.jsPsych.pluginAPI.clickTarget(o.querySelector("button"),s.rt)}};t.response_allowed_while_playing?n():p.addEventListener("ended",n)}}return v.info=g,v}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
