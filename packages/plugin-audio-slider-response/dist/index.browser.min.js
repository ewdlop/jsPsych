var jsPsychAudioSliderResponse=function(i){"use strict";function m(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}const y=r=>{const t=new Set;do for(const e of Reflect.ownKeys(r))t.add([r,e]);while((r=Reflect.getPrototypeOf(r))&&r!==Object.prototype);return t};var c=(r,{include:t,exclude:e}={})=>{const a=s=>{const n=l=>typeof l=="string"?s===l:l.test(s);return t?t.some(n):e?!e.some(n):!0};for(const[s,n]of y(r.constructor.prototype)){if(n==="constructor"||!a(n))continue;const l=Reflect.getOwnPropertyDescriptor(s,n);l&&typeof l.value=="function"&&(r[n]=r[n].bind(r))}return r},_=m(c),v="2.1.0",f=(r,t,e)=>new Promise((a,s)=>{var n=p=>{try{d(e.next(p))}catch(o){s(o)}},l=p=>{try{d(e.throw(p))}catch(o){s(o)}},d=p=>p.done?a(p.value):Promise.resolve(p.value).then(n,l);d((e=e.apply(r,t)).next())});const P={name:"audio-slider-response",version:v,parameters:{stimulus:{type:i.ParameterType.AUDIO,default:void 0},min:{type:i.ParameterType.INT,default:0},max:{type:i.ParameterType.INT,default:100},slider_start:{type:i.ParameterType.INT,default:50},step:{type:i.ParameterType.INT,default:1},labels:{type:i.ParameterType.HTML_STRING,default:[],array:!0},slider_width:{type:i.ParameterType.INT,default:null},button_label:{type:i.ParameterType.STRING,default:"Continue",array:!1},require_movement:{type:i.ParameterType.BOOL,default:!1},prompt:{type:i.ParameterType.HTML_STRING,default:null},trial_duration:{type:i.ParameterType.INT,default:null},response_ends_trial:{type:i.ParameterType.BOOL,default:!0},trial_ends_after_audio:{type:i.ParameterType.BOOL,default:!1},response_allowed_while_playing:{type:i.ParameterType.BOOL,default:!0}},data:{response:{type:i.ParameterType.INT},rt:{type:i.ParameterType.INT},stimulus:{type:i.ParameterType.STRING},slider_start:{type:i.ParameterType.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class u{constructor(t){this.jsPsych=t,this.response={rt:null,response:null},this.setupTrial=()=>{this.params.trial_ends_after_audio&&this.audio.addEventListener("ended",this.end_trial),!this.params.response_allowed_while_playing&&!this.params.trial_ends_after_audio&&this.audio.addEventListener("ended",this.enable_slider);var e='<div id="jspsych-audio-slider-response-wrapper" style="margin: 100px 0px;">';e+='<div class="jspsych-audio-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',this.params.slider_width!==null?e+=this.params.slider_width+"px;":e+="auto;",e+='">',e+='<input type="range" class="jspsych-slider" value="'+this.params.slider_start+'" min="'+this.params.min+'" max="'+this.params.max+'" step="'+this.params.step+'" id="jspsych-audio-slider-response-response"',this.params.response_allowed_while_playing||(e+=" disabled"),e+="></input><div>";for(var a=0;a<this.params.labels.length;a++){var s=100/(this.params.labels.length-1),n=a*(100/(this.params.labels.length-1)),l=(n-50)/50*100,d=l*this.half_thumb_width/100;e+='<div style="border: 1px solid transparent; display: inline-block; position: absolute; left:calc('+n+"% - ("+s+"% / 2) - "+d+"px); text-align: center; width: "+s+'%;">',e+='<span style="text-align: center; font-size: 80%;">'+this.params.labels[a]+"</span>",e+="</div>"}e+="</div>",e+="</div>",e+="</div>",this.params.prompt!==null&&(e+=this.params.prompt);var p="";if((this.params.require_movement||!this.params.response_allowed_while_playing)&&(p="disabled"),e+='<button id="jspsych-audio-slider-response-next" class="jspsych-btn" '+p+">"+this.params.button_label+"</button>",this.display.innerHTML=e,this.response={rt:null,response:null},this.params.response_allowed_while_playing||(this.display.querySelector("#jspsych-audio-slider-response-response").disabled=!0,this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!0),this.params.require_movement){const o=()=>{this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!1};this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("mousedown",o),this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("touchstart",o),this.display.querySelector("#jspsych-audio-slider-response-response").addEventListener("change",o)}this.display.querySelector("#jspsych-audio-slider-response-next").addEventListener("click",()=>{var o=performance.now(),h=Math.round(o-this.startTime);this.context!==null&&(o=this.context.currentTime,h=Math.round((o-this.startTime)*1e3)),this.response.rt=h,this.response.response=this.display.querySelector("#jspsych-audio-slider-response-response").valueAsNumber,this.params.response_ends_trial?this.end_trial():this.display.querySelector("#jspsych-audio-slider-response-next").disabled=!0}),this.startTime=performance.now(),this.context!==null&&(this.startTime=this.context.currentTime),this.audio.play(),this.params.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{this.end_trial()},this.params.trial_duration)},this.end_trial=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),this.audio.stop(),this.audio.removeEventListener("ended",this.end_trial),this.audio.removeEventListener("ended",this.enable_slider);var e={rt:this.response.rt,stimulus:this.params.stimulus,slider_start:this.params.slider_start,response:this.response.response};this.display.innerHTML="",this.trial_complete(e)},_(this)}trial(t,e,a){return f(this,null,function*(){return this.params=e,this.display=t,this.response,this.half_thumb_width=7.5,this.trial_complete,this.context=this.jsPsych.pluginAPI.audioContext(),this.audio=yield this.jsPsych.pluginAPI.getAudioPlayer(e.stimulus),this.setupTrial(),a(),new Promise(s=>{this.trial_complete=s})})}enable_slider(){document.querySelector("#jspsych-audio-slider-response-response").disabled=!1,this.params.require_movement||(document.querySelector("#jspsych-audio-slider-response-next").disabled=!1)}simulate(t,e,a,s){e=="data-only"&&(s(),this.simulate_data_only(t,a)),e=="visual"&&this.simulate_visual(t,a,s)}create_simulation_data(t,e){const a={stimulus:t.stimulus,slider_start:t.slider_start,response:this.jsPsych.randomization.randomInt(t.min,t.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)},s=this.jsPsych.pluginAPI.mergeSimulationData(a,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,s),s}simulate_data_only(t,e){const a=this.create_simulation_data(t,e);this.jsPsych.finishTrial(a)}simulate_visual(t,e,a){const s=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement(),l=()=>{if(s.rt!==null){const d=n.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(d),d.valueAsNumber=s.response},s.rt/2),this.jsPsych.pluginAPI.clickTarget(n.querySelector("button"),s.rt)}};this.trial(n,t,()=>{a(),t.response_allowed_while_playing?l():this.audio.addEventListener("ended",l)})}}return u.info=P,u}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
